<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no">
  <title>多叉树排版 | By田小号@codding.cn</title>
  <link rel="shortcut icon" type="image/x-icon" href="http://codding.cn/static-codding/img/favicon.ico?x">
  <style>
    * {padding: 0; margin: 0; font: inherit;}
    html, body {height: 100%;}
    body {overflow: hidden;}
    
    #img-box {position: absolute; left: 10px; top: 10px;}
    #img-box img {background: #999; margin-right: 10px;}

    #app {height: 100%;}
    #app canvas {width: 100%; height: 100%; vertical-align: top;}

    #btn-box {position: absolute; right: 20px; top: 20px;}
  </style>
</head>
<body>

<div id="app">
  <canvas id="canvas"></canvas>
  <div id="img-box"></div>
  <div id="btn-box">
    <button id="btnToggle">toggle 全部节点</button>
  </div>
</div>

<script src="./EquityMap.js"></script>
<script>
const treeView = new EquityMap({
  canvas,
  data: [
    {id: 1, pid: 0, name: 'id: 1, 阳光灿烂的日子，好听的歌儿随风飘，我们的回忆慢慢消失', cash: '认证金额：100万人民币', isControl: false, percent: '10%'},
    {id: 2, pid: 1, name: 'id: 2, 阳光灿烂的日子，好听的歌儿随风飘，我们的回忆慢慢消失', cash: '认证金额：200万人民币', isControl: false, percent: '20%', isPrev: true},
    {id: 3, pid: 1, name: 'id: 3, 阳光灿烂的日子，好听的歌儿随风飘，我们的回忆慢慢消失', cash: '认证金额：300万人民币', isControl: false, percent: '30%', isPrev: false},
    {id: 4, pid: 2, name: 'id: 4, 阳光灿烂的日子，好听的歌儿随风飘，我们的回忆慢慢消失', cash: '认证金额：400万人民币', isControl: false, percent: '40%'},
    {id: 5, pid: 2, name: 'id: 5, 阳光灿烂的日子，好听的歌儿随风飘，我们的回忆慢慢消失', cash: '认证金额：500万人民币', isControl: true, percent: '50%'},
    {id: 6, pid: 2, name: 'id: 6, 阳光灿烂的日子，好听的歌儿随风飘，我们的回忆慢慢消失', cash: '认证金额：600万人民币', isControl: true, percent: '60%'},
    {id: 7, pid: 3, name: 'id: 7, 阳光灿烂的日子，好听的歌儿随风飘，我们的回忆慢慢消失', cash: '认证金额：700万人民币', isControl: true, percent: '70%'},
    {id: 8, pid: 3, name: 'id: 8, 阳光灿烂的日子，好听的歌儿随风飘，我们的回忆慢慢消失', cash: '认证金额：800万人民币', isControl: false, percent: '80%'},
    {id: 9, pid: 3, name: 'id: 9, 阳光灿烂的日子，好听的歌儿随风飘，我们的回忆慢慢消失', cash: '认证金额：900万人民币', isControl: false, percent: '90%'},
    {id: 10, pid: 8, name: 'id: 10, 阳光灿烂的日子，好听的歌儿随风飘，我们的回忆慢慢消失', cash: '认证金额：1000万人民币', isControl: false, percent: '100%'},
    {id: 11, pid: 8, name: 'id: 11, 阳光灿烂的日子，好听的歌儿随风飘，我们的回忆慢慢消失', cash: '认证金额：1100万人民币', isControl: false, percent: '110%'},
  ],
  translate: {
    x: window.innerWidth / 2,
    y: window.innerHeight / 2,
  },
  conf: {
    lineHeight: 120,
    spaceBetween: 15,
    rect: {
      size: {
        width: 150,
        height: 60,
      }
    }
  },
  click(e, node) {
    console.log(node)
  }
})

const d = treeView.d
// treeView.destroy()

btnToggle.onclick = () => {
  btnToggle.clicked = !btnToggle.clicked
  d.data.forEach((v) => {
    v.isOpen = v.depth < 1 || btnToggle.clicked
  })
  treeView.setAnimate(d.root)
}

// treeView.ready(() => {
//   btnToggle.onclick()
// })
</script>

</body>
</html>